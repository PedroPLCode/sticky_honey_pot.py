import re
from utils.exception_handler import exception_handler
from config import SQL_ATTACK_PATTERNS

@exception_handler()
def detect_exploit(data):
    data = data.lower()
    matched_threats = []

    for pattern, threat_name in SQL_ATTACK_PATTERNS:
        if re.search(pattern, data):
            matched_threats.append(threat_name)

    return list(set(matched_threats)) if matched_threats else None